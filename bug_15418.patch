 source3/rpc_server/netlogon/srv_netlog_nt.c   | 1 +
 source4/rpc_server/netlogon/dcerpc_netlogon.c | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/source3/rpc_server/netlogon/srv_netlog_nt.c b/source3/rpc_server/netlogon/srv_netlog_nt.c
index 3ba58e61206f..9aea36a9d08e 100644
--- a/source3/rpc_server/netlogon/srv_netlog_nt.c
+++ b/source3/rpc_server/netlogon/srv_netlog_nt.c
@@ -2297,6 +2297,7 @@ NTSTATUS _netr_LogonGetCapabilities(struct pipes_struct *p,
 	}
 
 	if (r->in.query_level != 1) {
+		p->fault_state = DCERPC_NCA_S_FAULT_INVALID_TAG;
 		return NT_STATUS_NOT_SUPPORTED;
 	}
 
diff --git a/source4/rpc_server/netlogon/dcerpc_netlogon.c b/source4/rpc_server/netlogon/dcerpc_netlogon.c
index 6ccba65d3bf0..464093479966 100644
--- a/source4/rpc_server/netlogon/dcerpc_netlogon.c
+++ b/source4/rpc_server/netlogon/dcerpc_netlogon.c
@@ -2376,7 +2376,7 @@ static NTSTATUS dcesrv_netr_LogonGetCapabilities(struct dcesrv_call_state *dce_c
 	NT_STATUS_NOT_OK_RETURN(status);
 
 	if (r->in.query_level != 1) {
-		return NT_STATUS_NOT_SUPPORTED;
+		DCESRV_FAULT(DCERPC_NCA_S_FAULT_INVALID_TAG);
 	}
 
 	r->out.capabilities->server_capabilities = creds->negotiate_flags;
